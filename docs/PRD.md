# 一、背景与目标

## 1.1 背景说明

在前端开发、测试及原生开发过程中，**真机调试与操作**是不可避免的环节。当前行业现状是：

- Android / iOS / HarmonyOS 各自有 **完全不同的命令体系**
  - Android：adb / fastboot / scrcpy
  - iOS：xcrun / idevice / simctl / 第三方工具
  - HarmonyOS：hdc
- 常见操作高度碎片化：
  - 安装 / 卸载应用
  - 导入 Charles / 抓包证书
  - 截图、录屏、文件导入导出
- 大量能力依赖 **CLI + 文档记忆 + 手工执行**

这导致：
- 新成员上手成本高
- 跨平台操作极易出错
- 自动化与复用程度极低

## 1.2 产品目标

打造一个 **统一、可视化、跨平台的真机开发辅助工具**，以 GUI 方式封装底层命令，降低多端真机操作复杂度。

MVP 阶段目标：

- 一次接入，多端统一操作体验
- 覆盖最常用、最高频的真机能力
- 面向开发者个人或小团队本地使用

---

# 二、目标用户

## 2.1 用户角色

| 角色 | 使用场景 |
|----|----|
| 前端开发者 | H5 / Hybrid / RN / Flutter 真机调试 |
| 测试人员 | 安装包测试、截图录屏、问题复现 |
| 原生开发 | App 安装、日志、设备信息 |

## 2.2 用户特征

- 熟悉技术，但**不愿意记命令**
- 经常需要在不同系统、不同设备间切换
- 追求效率与稳定性

---

# 三、核心问题定义

## 3.1 现存问题

1. **操作成本高**
   - 同一能力在不同平台命令完全不同
2. **心智负担重**
   - 需要记忆大量参数与命令组合
3. **工具割裂**
   - 截图用一个工具，录屏用另一个工具
4. **难以标准化**
   - 团队内各自维护脚本，无法复用

## 3.2 关键诉求

- 用「按钮」而不是「命令」
- 用「统一抽象」而不是「平台差异」

---

# 四、产品定位

> **一句话描述**：

一个面向多端真机的本地开发辅助工具，采用类似 DevToys 的模块化交互模式，用统一 UI 封装 Android / iOS / HarmonyOS 的常用设备操作能力，并支持持续扩展开发者工具模块。

## 4.1 交互与体验原则（参考 DevToys）

- **工具即模块（Tool as Module）**：
  - 每一个能力都是一个独立的小模块
  - 模块之间相互独立、可插拔
- **左侧导航 + 右侧工作区**：
  - 左侧为模块列表（可搜索）
  - 右侧为当前模块的完整操作界面
- **无流程依赖**：
  - 用户可直接进入任意模块使用
  - 不强制操作顺序
- **低学习成本**：
  - 打开即用，无需阅读文档

## 4.2 模块扩展能力（核心设计目标）

- 平台必须支持**运行期持续扩展新的模块**，例如：
  - JSON 格式化 / 校验
  - Base64 编解码
  - 时间戳转换
  - Mock 数据生成
- 模块遵循统一规范：
  - 独立 UI
  - 独立状态
  - 统一注册机制

## 4.3 非目标（MVP 明确不做）

- 远程真机云
- 大规模设备并发调度
- 自动化测试平台

---

# 五、功能范围（MVP）

## 5.1 功能模块体系（可扩展，不写死）

> 模块为**动态注册单元**，以下仅为 **MVP 默认内置模块示例**，并非固定或写死。

```

【MVP 内置模块示例】

设备能力类（Device Tools）
 ├─ 设备管理（Device Manager）- 包含实时镜像、截图、设备信息查看
 ├─ 应用管理（App Manager）
 ├─ 文件管理（File Explorer）
 └─ 抓包证书管理（Certificate Manager）

通用工具类（Utility Tools）
 ├─ JSON 工具（示例）
 ├─ 编解码工具（示例）
 └─ 开发者常用工具（示例）
```

---

## 5.2 模块规范与扩展约定（MVP）

### 5.2.1 模块基本约定

- 模块为独立功能单元，需遵循统一接口规范
- 模块不允许依赖其他模块的内部状态
- 模块通过注册机制被平台加载

### 5.2.2 模块最小能力要求

每个模块至少包含：
- 模块元信息（名称 / 描述 / 分类 / 图标）
- 独立 UI 渲染入口
- 生命周期钩子（初始化 / 激活 / 销毁）

### 5.2.3 状态与上下文约定

- 设备选择为**全局上下文能力**
- 模块可选择是否消费设备上下文
- 其余状态模块内自治，不得外泄


---

## 5.3 设备管理模块

设备管理模块采用**可视化设备镜像**的交互方式，界面布局如下：

```
┌──────────────────────────────────────────────────────────┐
│                    设备管理模块                           │
├──────────────────────────────────────────────────────────┤
│                                                          │
│     ┌─────────────┐      ┌─────────────────────────┐    │
│     │             │      │ 设备信息                 │    │
│     │   手机模型   │      │ - 设备名称               │    │
│     │             │      │ - 型号                   │    │
│     │  [实时镜像]  │      │ - 系统版本               │    │
│     │             │      │ - 电量                   │    │
│     │             │      ├─────────────────────────┤    │
│     │             │      │ 操作                     │    │
│     │             │      │ [截图] [开始/停止镜像]    │    │
│     └─────────────┘      └─────────────────────────┘    │
│                                                          │
└──────────────────────────────────────────────────────────┘
```

### 5.3.1 中心区域 - 手机模型与实时镜像

- **手机模型框架**：
  - 未连接设备时：显示空白占位或提示文案（如"请连接设备"）
  - 设备连接后：在模型框架内显示设备的实时只读镜像画面
  - 镜像为只读模式，不支持在电脑端点击控制设备

### 5.3.2 右侧信息区

显示当前选中设备的基础信息：
- 设备名称
- 设备型号
- 系统版本
- 电量状态（带图标显示）
- 存储空间（可选）

### 5.3.3 操作区

位于信息区下方，提供快捷操作：
- **截图按钮**：一键截图当前设备屏幕，自动保存到本地配置的路径
- **镜像开关**：开始/停止实时镜像显示
  - 开始镜像：建立连接并显示实时画面
  - 停止镜像：断开连接，释放资源

### 5.3.4 设备扫描与刷新

- 支持自动扫描已连接的设备
- 提供手动刷新按钮
- 设备列表可在界面顶部或侧边显示，用于切换不同设备

---

## 5.4 应用管理模块

- 安装 / 卸载应用
- 支持拖拽文件安装
- 展示安装结果与日志

---

## 5.5 文件管理模块

- 文件导入 / 导出
- 常用目录快捷访问

---

## 5.6 抓包证书管理模块

- Charles 证书导入向导
- 当前证书状态展示

---

# 六、技术方案概述（非实现细节）


## 6.1 架构原则

- UI 与命令执行解耦
- 平台能力通过 Adapter 层统一抽象

```
UI 层
 ↓
统一能力接口
 ↓
平台适配层（Android / iOS / Harmony）
 ↓
系统命令执行
```

---

## 6.2 平台抽象示例

| 能力 | Android | iOS | HarmonyOS |
|----|----|----|----|
| 安装 | adb install | ideviceinstaller | hdc install |
| 截图 | adb screencap | xcrun | hdc shell |
| 实时镜像 | scrcpy (readonly) | 待定 | hdc shell |

---

# 七、非功能性需求

## 7.1 安装与分发要求（关键）

- 最终交付形态为 **即插即用的本地安装包**
- 用户完成安装后，应满足：
  - 无需额外配置环境变量
  - 无需手动安装第三方依赖
  - 无需再执行命令行初始化步骤

> 核心原则：**下载 → 安装 → 打开即可完整使用**

## 7.2 内置依赖策略

- 对于平台依赖工具：
  - Android：内置 adb（或首次启动自动下载）
  - HarmonyOS：内置 hdc
  - iOS：
    - 依赖系统自带工具（macOS）
    - 对缺失能力给出明确提示

- 所有依赖状态需在 UI 中可视化：
  - 可用 / 不可用
  - 原因说明

## 7.3 稳定性与体验要求

- 所有命令执行需有明确状态反馈
- 失败场景需提供可读错误信息
- 模块异常不应影响其他模块使用

---

# 八、风险与限制


| 风险 | 说明 |
|----|----|
| iOS 权限限制 | 部分能力依赖 macOS 环境 |
| 证书复杂度 | 不同系统版本差异较大 |
| 设备兼容性 | 不保证所有机型 100% 支持 |

---

# 九、MVP 成功标准

- 能稳定识别三端真机
- 覆盖 80% 日常高频操作
- 新用户无需查文档即可完成基础操作

---

# 十、后续可扩展方向（非 MVP）

- 设备日志实时查看
- 操作流程脚本化
- 团队配置共享
- 远程设备接入

